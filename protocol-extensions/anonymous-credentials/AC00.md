# Introduction and Core Models

`mandatory`

---

This document details the notation and models used throughout the specification. [Cashu-kvac]() is herein referenced as a black-box implementation of the cryptographic operations for Anonymous Credentials, so this specification **WON'T** delve into the mathematic details of the KVAC scheme.

## Terminology Differences

Here are some differences in terminology with respect to the main specifications:

* *proof* $\rightarrow$ *note*: *proof* assumes a different meaning in this context (Zero Knowledge Proofs) so in order to avoid equivocation, the term *note* will be used in its place.
* *Mint* is written with a capital `M`, avoiding equivocation with the verb *to mint*.

## Mint Keys

### Private Key
The Mint's *signing* private key, which will be used to issue notes:
```rust
let scalars = (0..6).map(|_| cashu_kvac::Scalar::random()).collect();
let mint_privkey = cashu_kvac::MintPrivateKey::from_scalars(&scalars).unwrap();
```

### Public Key
The Mint's *signing* Public Key, which can be used to verify notes client-side:
```rust
let mint_pubkey: cashu_kvac::MintPublicKey = mint_privkey.public_key.clone();
```

## Unsigned Note
An `UnsignedNote` is a note yet to be signed by the Mint:
```json
{
    "keyset_id": string,
    "amount": number,
    "script": string,
    "unit": string,
    "tag": 64-char-hex,
    "attributes": [cashu_kvac::AmountAttribute, cashu_kvac::ScriptAttribute],
}
```

where:
* `keyset_id` is the ID of the keyset that will sign this note
* `amount` is the amount this note represents
* (optional) `script` is a [NUT-10](10.md) spending condition
* `unit` is the unit of the note (e.g. "sat", "msat", "usd")
* `tag` is a unique identifier for this note, chosen by the client.
* `attributes` is a tuple containing a `AmountAttribute` and a `ScriptAttribute`.

## Output
`Output` is -as the name suggests- an output of a transaction. It is derived from an `UnsignedNote` as the following:
```json
{
    "id": string,
    "tag": 64-char-hex,
    "commitments": [66-char-hex, 66-char-hex],
}
```

where:
* `id` is `unsigned_note.keyset_id`
* `tag` is `unsigned_note.tag`
* `commitments` is a tuple containing the commiments from the original attributes: 
  * `unsigned_note.attributes.0.commitment()`
  * `unsigned_note.attributes.1.commitment()`.

## MAC
A `MAC` (Message Authentication Code) is the signature the Mint can issue on `Output`, using `MintPrivateKey`:

```rust
let mac = MAC::generate(
    &mint_privkey,
    &output.commitments.0,
    Some(&output.commitments.1),
    Some(output.tag),
)
```

## Note

A `Note` (or *signed note*) is a note that has received a `MAC` from the Mint.

```json
{
    "keyset_id": string,
    "amount": number,
    "script": string,
    "unit": string,
    "tag": 64-char-hex,
    "mac": 66-char-hex,
    "attributes": [cashu_kvac::AmountAttribute, cashu_kvac::ScriptAttribute],
    "issuance_proof": cashu_kvac::ZKP
}
```
where:
* `keyset_id`, `amount`, `script`, `unit` `attributes` and `tag` are the same as in `UnsignedNote`.
* `mac` is the signature value returned by the Mint
* `issuance_proof` is a Zero-Knowledge Proof returned by the Mint that confirms `MAC` was issued using `MintPublicKey`.

## Input

`Input` is an input to a transaction. It is derived from `Note` as the following:

```json
{
    ""
}
```