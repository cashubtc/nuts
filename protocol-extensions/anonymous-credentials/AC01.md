# AC-01: Mint public key exchange

`mandatory`

`depends on: NUT-01`

---

This document outlines the exchange of the public keys of the Mint with the wallet user.

## Description

Wallet user receives public keys from Mint via `GET /v1/kvac/keys`.

The Mint responds only with its `active` keysets. Keyset are `active` if the mint will sign outputs with it. The mint will accept tokens from inactive keysets as inputs but will not sign with them for new outputs. The `active` keysets can change over time, for example due to key rotation. A list of all keysets, active and inactive, can be requested separately (see [AC-02](AC-02)).

A wallet can ask for the keys of a specific (active or inactive) keyset via the endpoint `GET /v1/kvac/keys/{keyset_id}` (see [AC-02][02]).

## Supported Currency Units

Refer to [NUT-01](01), as there are no changes from the main spec.

## Keyset generation

Keysets are generated by the Mint. Each keyset contains exactly $1$ key, which is the `MintPublicKey` generated from `MintPrivateKey` as described in [AC-00](AC-00).
`MintPublicKey` is internally composed by $2$ public keys:

```json
{
  "Cw": "0312..3f",
  "I": "0213..10"
}
```

Therefore, its keyset `id` is computed from both of these values (see [AC-02](AC-02) and [NUT-02](02)). The mint **MUST** use the [compressed Secp256k1 public key format](https://learnmeabitcoin.com/technical/public-key#public-key-format) to represent its public keys.

## Network Requests

A client can request:

```http
GET https://mint.host:3338/v1/kvac/keys
```

With curl:

```bash
curl -X GET https://mint.host:3338/v1/kvac/keys
```

Response `GetKeysResponse` of the Mint:

```json
{
  "keysets": [
    {
      "id": <keyset_id_hex_str>,
      "unit": <currency_unit_str>,
      "final_expiry": <expiry_int>,
      "keys": {
        "Cw": <public_key_str>,
        "I": <public_key_str>,
      }
    },
    ...
  ]
}
```

Where:

- `id` is the keyset ID, recomputable by the client (see [AC-02](AC-02) and [NUT-02](02)).
- `unit` is the unit of the keyset.
- (optional) `final_expiry` is the unix epoch after which the keyset might be permanently deleted from the Mint's database (and thus any note issued from that keyset is invalidated).
- `keys` holds the decomposition of the `MintPublicKey` as explained above.

---

A client can also request:

```http
GET https://mint.host:3338/v1/kvac/keys/{keyset_id_hex_str}
```

With curl:

```bash
curl -X GET https://mint.host:3338/v1/kvac/keys/{keyset_id_hex_str}
```

In this case, the Mint will return the keyset -if it exists- regardless of its `active` status:

```json
{
  "keysets": [
    {
      "id": <keyset_id_hex_str>,
      "unit": <currency_unit_str>,
      "final_expiry": <expiry_int>,
      "keys": {
        "Cw": <public_key_str>,
        "I": <public_key_str>,
      }
    }
  ]
}
```

[01]: 01.md
[02]: 02.md
[AC-02]: AC02.md
[AC-00]: AC00.md
