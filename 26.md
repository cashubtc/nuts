
# NUT-26: OHTTP Transport for Mint APIs

`optional`

`depends on: NUT-06`

---

This NUT specifies how a Cashu mint can offer its HTTP API over Oblivious HTTP (OHTTP) to improve network‑level privacy for wallets. OHTTP lets a client send encrypted requests to an oblivious gateway (optionally via a relay). The gateway decrypts, forwards the plaintext HTTP request to the mint, and encrypts the response, preventing the mint from learning the client's network address and preventing the relay from seeing request contents.

This NUT does not change any existing Cashu API semantics. It only defines discovery and endpoints needed to use OHTTP with a mint.

## Terminology

- OHTTP: Oblivious HTTP as specified by the IETF OHAI working group.
- Gateway: The component that holds the OHTTP key config, decapsulates requests, forwards them to the mint backend, and encapsulates responses.
- Relay: A forwarder that sees only encrypted OHTTP messages and forwards them to the gateway.

## Discovery via NUT‑06

Mints advertise OHTTP support in the `nuts` section of the [NUT‑06][06] `GetInfoResponse`.

```json
"nuts": {
  ...,
  "26": {
    "enabled": true,
    "gateway_url": "https://ohttp.example.com" // optional
  }
}
```

Fields:

- `enabled` (bool): Set to `true` when the mint supports OHTTP.
- `gateway_url` (str|null, optional): Base URL of the OHTTP gateway to use for key discovery (and, by convention, for the OHTTP gateway endpoint). If omitted or `null`, clients SHOULD assume the gateway is available on the mint's own origin.

Wallets SHOULD treat `gateway_url` as a hint for where to fetch OHTTP keys. A mint MAY operate the gateway on the same origin as the mint API, in which case `gateway_url` can be omitted.

## Gateway Endpoints

A gateway MUST expose the following endpoints:

- `GET /ohttp-keys` → returns the OHTTP key configuration
  - Response content type: `application/ohttp-keys`
  - Body: opaque binary OHTTP key configuration as defined by the OHTTP specification

- `POST /.well-known/ohttp-gateway` → accepts encapsulated OHTTP requests
  - Request content type: `message/ohttp-req`
  - Response content type: `message/ohttp-res`
  - Body: opaque binary as defined by OHTTP

A deployment MAY route additional paths to the same handler (e.g., a catch‑all that accepts `message/ohttp-req`); clients MUST NOT rely on nonstandard paths.

## Client Behavior

- Key fetch: Wallets fetch the OHTTP key configuration from `gateway_url + "/ohttp-keys"`. If `gateway_url` is not provided, wallets SHOULD fetch from the mint origin at `"/ohttp-keys"`.
- Encapsulation: Wallets construct a BHTTP request that mirrors a normal Cashu API call (method, scheme, authority, path, headers, and body), encapsulate it with the fetched key config, and send it to the OHTTP gateway endpoint at `"/.well-known/ohttp-gateway"` through a relay.
- Headers: Wallets include the same application‑level headers they would send directly to the mint (e.g., auth headers if applicable). The gateway forwards headers to the mint backend.
- Paths: The BHTTP request path is the regular Cashu API path (e.g., `/v1/mint/quote/bolt11`, `/v1/melt/bolt11`, `/v1/swap`, etc.). The gateway forwards the request to the mint backend preserving method, path, headers, and body.

Wallets MUST send OHTTP messages through a relay to the gateway.

## Errors

Gateways SHOULD respond with appropriate HTTP status codes for transport‑level errors. Since request/response bodies are OHTTP‑encapsulated, application‑level Cashu errors remain unchanged and are handled by the wallet after decapsulation.

## Security Considerations

- OHTTP provides network‑level unlinkability between client and mint. It does not hide application data from the gateway operator; the gateway must be trusted to forward requests without inspection or logging unless operated by the mint itself and configured for stateless processing.
- Mints MUST publish valid OHTTP key configurations and rotate them as needed per the OHTTP specification.
- Wallets SHOULD validate URLs derived from mint info to avoid SSRF or downgrade attacks. If both direct HTTP and OHTTP are available, wallets SHOULD prefer OHTTP when a relay/gateway is configured and keys can be fetched successfully.

[06]: 06.md
