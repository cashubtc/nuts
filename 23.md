# NUT-23: HTTP 402 Payment Required

`optional`

`uses: NUT-12`

`depends on: NUT-18`

---

This NUT describes how Cashu tokens can be used with HTTP 402 Payment Required responses to enable payments for HTTP resources.

### Server response

HTTP servers may respond with the HTTP status code 402 with a `X-Cashu` header containing an [encoded][18-encoding] NUT-18 [payment request][18] with the following fields:

```
{
    "a": int,
    "u": str,
    "m": Array[str],
    "p2pk": P2PKOption <optional>
}
```

- `a`: The amount required in the specified unit
- `u`: The currency unit (e.g., "sat", "usd", "api")
- `m`: Array of mint URLs that the server accepts tokens from
- `p2pk`: Optional P2PK requirements

### Client payment

After receiving a 402 response with a `X-Cashu` header, the client may retry the request with a `cashuB` token in the `X-Cashu` header as payment.

The token MUST be from one of the mints listed in the `mints` array, and MUST be of the same `unit` and greater than or equal to the `amount`.

> [!IMPORTANT]
>
> **P2PK:** If the service expects a P2PK-locked token, it MUST validate the P2PK script, require [DLEQ proofs][12], and check for double-spending.

## Payment response

If the server receives tokens from a mint that is not in the `mints` array, an incorrect `unit`, an insufficient amount of tokens, or with insufficient locking conditions, it should respond with a HTTP `400` status code.

[12]: 12.md
[18]: 18.md
[18-encoding]: 18.md#encoded-request
